<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0" />
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache"> 
<META HTTP-EQUIV="Expires" CONTENT="0">
<title>个人中心</title>
<script src="js/jquery1.8.3.js"></script>
<script src="js/rem.js"></script>
<link rel="stylesheet" type="text/css" href="css/style.css" />
<script src="js/browser.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="js/base.js" type="application/javascript"></script>
</head>

<body>
<div id="app">
	<div class="maincontent" >
		<div class="main_box">
			<div class="user_top">
				<div class="user_img flex">
					<div class="user_photo"></div>
					<div class="user_name font32 color1">米桃子</div>
				</div>
				<div class="member flexRowBetween font28 color1">
					<div class="member_left">会员:普通会员</div>
					<div class="member_right"><a href="index2_infor.html">完善信息</a></div>
				</div>
			</div>
		</div>
		<div class="user_infor flexRowBetween w710 font28 color3">
	        <div class="user_left flex">
	            <img src="images/user1.png">
	            <a href="index2_order.html">订单管理</a>
	        </div>
	        <a class="next_page" href="index2_order.html">
	            <img src="images/next_page.jpg">
	        </a>
	    </div>
	    <div class="user_infor flexRowBetween w710 font28 color3">
	        <div class="user_left flex">
	            <img src="images/user2.png">
	            <a href="index2_account.html">账户管理</a>
	        </div>
	        <a class="next_page" href="index2_account.html">
	            <img src="images/next_page.jpg">
	        </a>
	    </div>
	    <div class="user_infor flexRowBetween w710 font28 color3">
	        <div class="user_left flex">
	            <img src="images/user3.png">
	            <a href="index2_merchant_back.html">我的反馈</a>
	        </div>
	        <a class="next_page"  href="index2_merchant_back.html">
	            <img src="images/next_page.jpg">
	        </a>
	    </div>
	    <div class="user_infor flexRowBetween w710 font28 color3">
	        <div class="user_left flex">
	            <img src="images/user4.png">
	            <a href="index2_contact.html">联系我们</a>
	        </div>
	        <a class="next_page"  href="index2_contact.html">
	            <img src="images/next_page.jpg">
	        </a>
	    </div>
	    <div class="user_infor flexRowBetween w710 font28 color3">
	        <div class="user_left flex">
	            <img src="images/user5.png">
	            <a href="note.html">公告</a>
	        </div>
	        <a class="next_page"  href="note.html">
	            <img src="images/next_page.jpg">
	        </a>
	    </div>
		<div style="height:1.2rem;width:100%;"></div>
		<div class="navbar">
		    <a class="navbar_item" href="index.html">
		        <div class="nav_img">
		            <img src="images/navbar1.png">
		        </div>
		        <div class="text">权益资讯</div>
		    </a>
		    <a class="navbar_item" href="index1.html">
		        <div class="nav_img">
		            <img src="images/navbar2.png">
		        </div>
		        <div class="text">帮助中心</div>
		    </a>
		    <a class="navbar_item" href="index2.html">
		        <div class="nav_img">
		            <img src="images/navbar3-a.png">
		        </div>
		        <div class="text this-text">我的</div>
		    </a>
		</div>
	</div>
</div>

<script type="text/javascript">
			
			var app = new Vue({
				el: '#app',
				data: function() {
					return {
						bannerData:[],
						artData:[],
						submitData:{
							content:'',
							title:'',
							phone:'',
							mainImg:[]
						},
						picFlag:false,
						isAnonymous:false,
						paginate: {
							
							count: 0,
							currentPage: 1,
							pagesize: 6,
							is_page: true,
						},

						searchItem:{
							
						},
						pageArray:[],
						allPages:0,
						linkPage:'',
						isIos:false
					}

				},
				
				created: function () {

					this.getBannerData();
				    this.getartData()
				},

				methods:{

					getBannerData() {
						var self = this;
						var ua = navigator.userAgent.toLowerCase();
   						
					    self.isIos = (ua.indexOf('iphone') != -1) || (ua.indexOf('ipad') != -1);

						var postData = {
						    count: 0,
						    currentPage: 1,
						    is_page: true,
						    pagesize:1,
						    searchItem:{
								thirdapp_id:12,
								title:'轮播图'
							}
					    };

						var callback = (res)=>{
							self.bannerData = res.info.data[0]['mainImg'];
						};
						window.base.labelGet(postData,callback);
					},		



					messageAdd() {
						var self = this;
						var postData = {
							data:{
								title:self.submitData.title,
								phone:self.submitData.phone,
								content:self.submitData.content,	
								mainImg:self.submitData.mainImg,
								user_type:0,
								thirdapp_id:12,	
							}
					    };
						var callback = (res)=>{
							if(res.solely_code==100000){
						
								alert('提交成功');
								window.location.reload()
							}else{
								alert('网络故障')
							}
						};
						window.base.messageAdd(postData,callback);
					},


					getartData(){
					    const self = this;
					    const postData = {};
					    postData.searchItem = {
					      thirdapp_id:12
					    };
					    postData.getBefore = {
					      article:{
					        tableName:'label',
					        searchItem:{
					          title:['=',['注意事项']],
					        },
					        middleKey:'menu_id',
					        key:'id',
					        condition:'in',
					      },
					    };
					    const callback = (res)=>{
					      if(res.info.data.length>0){
					        self.artData = res.info.data;
					      };
					      console.log(self.artData);
					   
					    };
					    window.base.articleGet(postData,callback);
					},

					upload(e){
						var self = this;
						var file = e.target.files[0];
						console.log(file)
						var param = new FormData();
						param.append('file',file,file.name);
						param.append('thirdapp_id',12);
						console.log(param.get('file'))
						
						var callback = function (res) {
							if(res.solely_code==100000&&res.info&&res.info.url){ 
	              				self.submitData.mainImg.push({url:res.info.url})
	              			}
						};
						
						var res = window.base.upLoadImg(param,callback);
						
					},


					ifAnonymous(){
						var self = this;
						console.log(666)
						self.isAnonymous = !self.isAnonymous
						console.log(self.isAnonymous)
					},

					submit(){
						var self = this;
						
						var newObject = window.base.cloneForm(self.submitData);

						delete newObject.mainImg;
						if(self.isAnonymous){
							delete newObject.phone;
							delete newObject.title;
						};
						const pass = window.base.checkComplete(newObject);
						if(pass){
							self.messageAdd()
						}else{
							alert('请补全信息')
						};	
						
					
						
					},



				}
			});
			
		</script>
</body>
</html>
